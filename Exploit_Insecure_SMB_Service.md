# Exploit 4: Insecure SMB Service Exploit

## Discovery Process

Conducted an Nmap scan of the target to identify open ports and running services:

[NMap Image]

Identified the SMB service running on port 445, which is commonly used for file sharing and network resource access.

## Exploitation:

### Step 1: Enumerating SMB Shares

Used the smbclient utility on the Kali Linux VM to list available shares:

Command:

[Image smbclient -L \\192.168.1.184]

## Output:
This revealed publicly accessible SMB shares, including "Anonymous" and "Public", with no authentication required.

### Step 2: Accessing the Anonymous Share

Attempted to connect to the "Anonymous" share using smbclient without providing a username or password:

Command:

smbclient \\192.168.1.184\Anonymous -N

### Explanation of Command:

\\192.168.1.184\Anonymous: Specifies the target IP address and the share name "Anonymous."

-N: Suppresses the prompt for credentials, attempting access with no authentication.

### Result:
Successfully accessed the "Anonymous" share, which allowed unrestricted read and write access to files.

Step 3: Uploading a Malicious Payload

Uploaded a test file to verify write access, then successfully uploaded a malicious payload (reverse shell):

Command:

put reverse_shell.exe

Result:
The payload was uploaded to the "Anonymous" share and executed remotely, providing a reverse shell back to the attacker machine.

### Step 4: Extracting Sensitive Information

Explored the "Public" share and discovered sensitive files containing:

Plaintext credentials.

Configuration files with additional network information.

Proof of Work:

Access to sensitive files was demonstrated using:

dir
get credentials.txt

Reverse shell connection established, providing full control over the target system.

Recommendations for Mitigation:

Disable Anonymous SMB Access:

Modify the SMB configuration to prevent unauthenticated access to shares.

Enforce Strong Authentication Policies:

Require all users to authenticate with strong, unique credentials when accessing SMB shares.

Restrict SMB Share Permissions:

Implement the principle of least privilege to limit user access to only necessary files and directories.

Use Secure SMB Protocols:

Disable older, insecure SMB versions (e.g., SMBv1) and enforce the use of SMBv3 with encryption.

Enable Auditing and Monitoring:

Enable logging to track file access and modifications.

Deploy intrusion detection tools like Snort or Suricata to monitor SMB traffic.

Implement Network Segmentation:

Isolate sensitive SMB servers to reduce exposure to unauthorized access.

Use Intrusion Prevention Tools:

Deploy fail2ban to block repeated unauthorized connection attempts to SMB services.
